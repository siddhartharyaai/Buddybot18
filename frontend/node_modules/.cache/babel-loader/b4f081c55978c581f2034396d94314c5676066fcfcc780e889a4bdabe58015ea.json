{"ast":null,"code":"import React,{useState}from'react';import{motion}from'framer-motion';import{MicrophoneIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VoiceControl=_ref=>{let{onStartAmbientListening,onStopAmbientListening,darkMode}=_ref;const[micStatus,setMicStatus]=useState('offline');// 'offline', 'requesting', 'ready', 'listening'\nconst handleStartVoice=async()=>{console.log('🎤 User clicked Start Voice button');setMicStatus('requesting');try{console.log('🎤 Requesting microphone permission...');// Request microphone permission with explicit user gesture\nconst stream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:true,noiseSuppression:true,sampleRate:44100}});console.log('✅ Microphone permission granted!');// Permission granted: proceed with ambient listening\nconst success=await onStartAmbientListening(stream);if(success){setMicStatus('listening');console.log('🎤 Ambient listening started - ready for \"Hey Buddy\"');}else{setMicStatus('offline');console.error('❌ Failed to start ambient listening');}}catch(error){console.error('❌ Microphone permission denied:',error);setMicStatus('offline');// Provide user guidance\nif(error.name==='NotAllowedError'){alert('🎤 Microphone access denied. Please:\\n1. Click the microphone icon in your browser address bar\\n2. Select \"Allow\"\\n3. Refresh the page and try again');}else{alert('🎤 Could not access microphone. Please check your device settings and try again.');}}};const handleStopVoice=()=>{console.log('🔇 User clicked Stop Voice button');onStopAmbientListening();setMicStatus('offline');};const getButtonStyle=()=>{switch(micStatus){case'ready':case'listening':return'bg-green-500 text-white shadow-lg shadow-green-500/25 hover:bg-green-600';case'requesting':return'bg-yellow-500 text-white shadow-lg shadow-yellow-500/25 animate-pulse';case'offline':default:return darkMode?'bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white':'bg-gray-200 text-gray-600 hover:bg-gray-300';}};const getStatusText=()=>{switch(micStatus){case'requesting':return'Requesting permission...';case'ready':return'Voice ready - waiting for wake word';case'listening':return'Always On - Say \"Hey Buddy\"';case'offline':default:return'Offline';}};const getButtonText=()=>{switch(micStatus){case'requesting':return'Starting...';case'ready':case'listening':return'Voice Active';case'offline':default:return'Start Voice';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center space-y-2\",children:[/*#__PURE__*/_jsx(motion.button,{type:\"button\",onClick:micStatus==='offline'||micStatus==='requesting'?handleStartVoice:handleStopVoice,disabled:micStatus==='requesting',whileHover:{scale:micStatus!=='requesting'?1.05:1},whileTap:{scale:micStatus!=='requesting'?0.95:1},className:\"p-4 rounded-full transition-all duration-300 \".concat(getButtonStyle()),title:getStatusText(),children:/*#__PURE__*/_jsx(MicrophoneIcon,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs px-3 py-1 rounded-full \".concat(micStatus==='listening'||micStatus==='ready'?'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200':micStatus==='requesting'?'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200':'bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400'),children:getStatusText()}),micStatus==='offline'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-center max-w-xs \".concat(darkMode?'text-gray-400':'text-gray-500'),children:\"Click to grant microphone permission and start voice chat\"}),micStatus==='listening'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-center max-w-xs \".concat(darkMode?'text-green-400':'text-green-600'),children:\"\\uD83C\\uDFA4 Ready! Say \\\"Hey Buddy\\\" to start talking\"})]});};export default VoiceControl;","map":{"version":3,"names":["React","useState","motion","MicrophoneIcon","jsx","_jsx","jsxs","_jsxs","VoiceControl","_ref","onStartAmbientListening","onStopAmbientListening","darkMode","micStatus","setMicStatus","handleStartVoice","console","log","stream","navigator","mediaDevices","getUserMedia","audio","echoCancellation","noiseSuppression","sampleRate","success","error","name","alert","handleStopVoice","getButtonStyle","getStatusText","getButtonText","className","children","button","type","onClick","disabled","whileHover","scale","whileTap","concat","title"],"sources":["/app/frontend/src/components/VoiceControl.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { MicrophoneIcon } from '@heroicons/react/24/outline';\n\nconst VoiceControl = ({ onStartAmbientListening, onStopAmbientListening, darkMode }) => {\n  const [micStatus, setMicStatus] = useState('offline'); // 'offline', 'requesting', 'ready', 'listening'\n\n  const handleStartVoice = async () => {\n    console.log('🎤 User clicked Start Voice button');\n    setMicStatus('requesting');\n    \n    try {\n      console.log('🎤 Requesting microphone permission...');\n      \n      // Request microphone permission with explicit user gesture\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          sampleRate: 44100\n        } \n      });\n      \n      console.log('✅ Microphone permission granted!');\n      \n      // Permission granted: proceed with ambient listening\n      const success = await onStartAmbientListening(stream);\n      \n      if (success) {\n        setMicStatus('listening');\n        console.log('🎤 Ambient listening started - ready for \"Hey Buddy\"');\n      } else {\n        setMicStatus('offline');\n        console.error('❌ Failed to start ambient listening');\n      }\n      \n    } catch (error) {\n      console.error('❌ Microphone permission denied:', error);\n      setMicStatus('offline');\n      \n      // Provide user guidance\n      if (error.name === 'NotAllowedError') {\n        alert('🎤 Microphone access denied. Please:\\n1. Click the microphone icon in your browser address bar\\n2. Select \"Allow\"\\n3. Refresh the page and try again');\n      } else {\n        alert('🎤 Could not access microphone. Please check your device settings and try again.');\n      }\n    }\n  };\n\n  const handleStopVoice = () => {\n    console.log('🔇 User clicked Stop Voice button');\n    onStopAmbientListening();\n    setMicStatus('offline');\n  };\n\n  const getButtonStyle = () => {\n    switch (micStatus) {\n      case 'ready':\n      case 'listening':\n        return 'bg-green-500 text-white shadow-lg shadow-green-500/25 hover:bg-green-600';\n      case 'requesting':\n        return 'bg-yellow-500 text-white shadow-lg shadow-yellow-500/25 animate-pulse';\n      case 'offline':\n      default:\n        return darkMode \n          ? 'bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white' \n          : 'bg-gray-200 text-gray-600 hover:bg-gray-300';\n    }\n  };\n\n  const getStatusText = () => {\n    switch (micStatus) {\n      case 'requesting':\n        return 'Requesting permission...';\n      case 'ready':\n        return 'Voice ready - waiting for wake word';\n      case 'listening':\n        return 'Always On - Say \"Hey Buddy\"';\n      case 'offline':\n      default:\n        return 'Offline';\n    }\n  };\n\n  const getButtonText = () => {\n    switch (micStatus) {\n      case 'requesting':\n        return 'Starting...';\n      case 'ready':\n      case 'listening':\n        return 'Voice Active';\n      case 'offline':\n      default:\n        return 'Start Voice';\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center space-y-2\">\n      <motion.button\n        type=\"button\"\n        onClick={micStatus === 'offline' || micStatus === 'requesting' ? handleStartVoice : handleStopVoice}\n        disabled={micStatus === 'requesting'}\n        whileHover={{ scale: micStatus !== 'requesting' ? 1.05 : 1 }}\n        whileTap={{ scale: micStatus !== 'requesting' ? 0.95 : 1 }}\n        className={`p-4 rounded-full transition-all duration-300 ${getButtonStyle()}`}\n        title={getStatusText()}\n      >\n        <MicrophoneIcon className=\"w-6 h-6\" />\n      </motion.button>\n      \n      {/* Status indicator */}\n      <div className={`text-xs px-3 py-1 rounded-full ${\n        micStatus === 'listening' || micStatus === 'ready' \n          ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n          : micStatus === 'requesting'\n          ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'\n          : 'bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400'\n      }`}>\n        {getStatusText()}\n      </div>\n\n      {/* Instructions for first-time users */}\n      {micStatus === 'offline' && (\n        <div className={`text-xs text-center max-w-xs ${\n          darkMode ? 'text-gray-400' : 'text-gray-500'\n        }`}>\n          Click to grant microphone permission and start voice chat\n        </div>\n      )}\n      \n      {micStatus === 'listening' && (\n        <div className={`text-xs text-center max-w-xs ${\n          darkMode ? 'text-green-400' : 'text-green-600'\n        }`}>\n          🎤 Ready! Say \"Hey Buddy\" to start talking\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VoiceControl;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}